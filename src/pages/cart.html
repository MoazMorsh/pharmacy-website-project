<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cart</title>
  <link rel="icon" href="https://assets.pharmeasy.in/apothecary/images/favicon.png">
  <!-- font awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta2/css/all.min.css" integrity="sha512-YWzhKL2whUzgiheMoBFwW8CKV4qpHQAEuvilg9FAn5VJUDwKZZxkJNuGM4XkWuk94WCrrwslk8yWNGmY1EduTA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="../assets/css/cart.css">
    <style>
    .quantity-btn {
    padding: 2px 8px;
    margin: 0 5px;
    cursor: pointer;
}

.remove-btn {
    background: #ff4444;

}

.remove-btn:hover {
    background: #cc0000;
}

#cart-items img {
    vertical-align: middle;
    margin-right: 10px;
}
    </style>
</head>
<body>

       <!-- header -->
       <header class="header bg-blue">
        <nav class="navbar bg-blue">
            <div class="container flex">
                
                <!-- <a href="https://moazmorsh.github.io/pharmacy-website-project/index.html" target="_self" class="logo">
                    <i class="fa fa-medkit"></i> Meditrack
                </a> -->
                <a href="/" target="_self" class="logo">
                    <i class="fa fa-medkit"></i> Meditrack
                </a>
                
                <div style="position: relative;">
                    <div class="profile-icon" onclick="togglePopup()"><i class="fas fa-user"></i></div>
                  
                    <div class="popup" id="profilePopup">
                        <a id="profileLink" href="#">
                            <span id="profileLinkText"></span> 
                            <i class="fas fa-external-link-alt" style="margin-left: 5px;"></i>
                        </a>
                        <p><strong>Username:</strong></p>
                        <p><strong>Email:</strong></p>
                        <p><strong>Role:</strong></p>
                        
                        <a href="/pages/edit-profile.html" class="edit-profile" style="color: #3498db; display: block; margin-top: 10px;">
                            <i class='fas fa-user-edit' style="color: #3498db; margin-right: 5px;"></i>
                            <span class="text">Edit Profile</span>
                        </a>
                        
                        <a href="#" class="logout" onclick="logout()" style="color: red; display: block; margin-top: 10px;">
                            <i class='fas fa-sign-out-alt' style="color: red; margin-right: 5px;"></i>
                            <span class="text">Logout</span>
                        </a>
                    </div>
                      
                  </div>
                  
                <button type="button" class="navbar-show-btn">
                    <img src="../assets/images/ham-menu-icon.png">
                </button>

                <div class="navbar-collapse bg-white">
                    <button type="button" class="navbar-hide-btn">
                        <img src="../assets/images/close-icon.png ">
                    </button>
                    <!-- <ul class="navbar-nav">
                        <li class="nav-item"><a href="https://moazmorsh.github.io/pharmacy-website-project/index.html" class="nav-link">Home</a></li>
                        <li class="nav-item"><a href="https://moazmorsh.github.io/pharmacy-website-project/index.html#services" class="nav-link">Subscription</a></li>
                        <li class="nav-item"><a href="https://moazmorsh.github.io/pharmacy-website-project/index.html#banner-two" class="nav-link">Quick Order</a></li>
                        <li class="nav-item"><a href="products.html" class="nav-link">Products</a></li>
                        <li class="nav-item"><a href="cart.html" class="nav-link" id="cart-link"> Cart <span id="cart-counter">(0)</span>
                        </a></li>
                    </ul> -->
                    <ul class="navbar-nav">
                        <li class="nav-item"><a href="/" class="nav-link">Home</a></li>
                        <li class="nav-item"><a href="/#services" class="nav-link">Subscription</a></li>
                        <li class="nav-item"><a href="/#banner-two" class="nav-link">Quick Order</a></li>
                        <li class="nav-item"><a href="products.html" class="nav-link">Products</a></li>
                        <li class="nav-item"><a href="cart.html" class="nav-link" id="cart-link"> Cart <span id="cart-counter">(0)</span>
                        </a></li>
                    </ul>
                    <div class="search-bar">
    <!-- <form id="searchForm">
        <input type="search" id="searchBar" class="search-control" placeholder="Search products">
        <button type="button" id="search-button">Search</button>
    </form> -->
</div>
                    
                </div> 
            </div>
        </nav>
    </header>
    <!-- end of header -->

    <main>
        <section id="cart">
          <h1>Your Shopping Cart</h1>
          <table>
              <thead>
                  <tr>
                      <th>Product</th>
                      <th>Quantity</th>
                      <th>Price</th>
                      <th>Total</th>
                      <th>Action</th>
                  </tr>
              </thead>
              <tbody id="cart-items">
                  <!-- Cart items will be loaded here dynamically -->
              </tbody>
          </table>

          <div class="cart-summary">
              <h2>Cart Summary</h2>
              <p>Total: £<span id="cart-total">0.00</span></p>
              <button id="checkout-btn" onclick="window.location.href='checkout.html'">Proceed to Checkout</button>

          </div>
        </section>

    </main>

  <!-- footer  -->
  <footer id = "footer" class = "footer text-center">
    <div class = "container">
        <div class = "footer-inner text-white py grid">
            <div class = "footer-item">
                <h3 class = "footer-head">about us</h3>
                <div class = "icon">
                    <img src = "">
                </div>
                <p class = "text text-md">Meditrack is more than a service—it’s a commitment to your health. We ensure timely, reliable medicine deliveries, so you never have to worry about missing a dose!</p>
                <ul>
                    <h3 class="footer-head"></h3>
                    <li>Order Medicine</li>
                    <li>HealthCare Products</li>
                    <li>Health Blog</li>
                </ul>
            </div>

            <div class = "footer-item">
                <h3 class = "footer-head">tags</h3>
                <ul class = "tags-list flex">
                    <li>COVID Essentials</li>
                    <li>Personal Care</li>
                    <li>Health Food & Drinks</li>
                    <li>Supplements</li>
                    <li>Mother & Baby Care</li>
                    <li>Home Care</li>
                </ul>
            </div>

            <div class = "footer-item">
                <h3 class = "footer-head">Quick Links</h3>
                <ul>
                    <li><a href = "#" class = "text-white">Our Services</a></li>
                    <li><a href = "#" class = "text-white">Our Plan</a></li>
                    <li><a href = "#" class = "text-white">Privacy Policy</a></li>
                    
                </ul>
            </div>

            <div class = "footer-item">
                <h3 class = "footer-head">Make your first Order</h3>
                <p class = "text text-md">Customer Support Here for You.</p>
                <ul class = "appointment-info">
                    <li>8:00 AM - 11:00 AM</li>
                    <li>2:00 PM - 05:00 PM</li>
                    <li>8:00 PM - 11:00 PM</li>
                    <li>
                        <i class = "fas fa-envelope"></i>
                        <span>meditrack@gmail.com</span>
                    </li>
                    <li>
                        <i class = "fas fa-phone"></i>
                        <span>+02 2411-5401</span>
                    </li>
                </ul>
            </div>
        </div>

        <div class = "footer-links">
            <ul class = "flex">
                <li><a href = "#" class = "text-white flex"> <i class = "fab fa-facebook-f"></i></a></li>
                <li><a href = "#" class = "text-white flex"> <i class = "fab fa-twitter"></i></a></li>
                <li><a href = "#" class = "text-white flex"> <i class = "fab fa-linkedin"></i></a></li>
            </ul>
        </div>
    </div>
  </footer>
  <!-- end of footer  -->



  <script>
    document.addEventListener('DOMContentLoaded', function() {
    // Load cart from localStorage or initialize empty cart
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    const cartItemsContainer = document.getElementById('cart-items');
    const cartTotalElement = document.getElementById('cart-total');

    // Function to render cart items
    function renderCart() {
        cartItemsContainer.innerHTML = '';
        let total = 0;

        if (cart.length === 0) {
            cartItemsContainer.innerHTML = '<tr><td colspan="5">Your cart is empty</td></tr>';
            cartTotalElement.textContent = '0.00';
            return;
        }

        cart.forEach((item, index) => {
            const itemTotal = item.price * item.quantity;
            total += itemTotal;

            const row = document.createElement('tr');
            row.innerHTML = `
                <td>
                    
                    ${item.name}
                </td>
                <td>
                    <button class="quantity-btn" onclick="updateQuantity(${index}, -1)">-</button>
                    <span class="quantity">${item.quantity}</span>
                    <button class="quantity-btn" onclick="updateQuantity(${index}, 1)">+</button>
                </td>
                <td>£${item.price.toFixed(2)}</td>
                <td>£${itemTotal.toFixed(2)}</td>
                <td><button class="remove-btn" onclick="removeItem(${index})">Remove</button></td>
            `;
            cartItemsContainer.appendChild(row);
        });

        cartTotalElement.textContent = total.toFixed(2);
    }

    // Function to update quantity
    window.updateQuantity = function(index, change) {
        const newQuantity = cart[index].quantity + change;
        
        if (newQuantity < 1) {
            removeItem(index);
            return;
        }
        
        cart[index].quantity = newQuantity;
        saveCart();
        renderCart();
    }

    // Function to remove item
    window.removeItem = function(index) {
        cart.splice(index, 1);
        saveCart();
        renderCart();
    }

    // Function to save cart to localStorage
    function saveCart() {
        localStorage.setItem('cart', JSON.stringify(cart));
    }

    // Initial render
    renderCart();
});
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
        const xhr = new XMLHttpRequest();
        xhr.open("GET", "/api/test", true); // async GET request to your test API
        xhr.onload = function () {
          if (xhr.status === 200) {
            const response = JSON.parse(xhr.responseText);
            console.log("✅ AJAX Test Response:", response.message);
          } else {
            console.error("❌ Error calling /api/test:", xhr.statusText);
          }
        };
        xhr.onerror = function () {
          console.error("❌ AJAX request failed due to network error.");
        };
        xhr.send();
    });
    </script>
    
<script>
    function logout() {
        if (confirm('Are you sure you want to logout?')) {
            localStorage.clear();
            sessionStorage.clear();
            console.log("✅ User logged out successfully.");
            window.location.href = '/pages/login.html';
        }
        }
</script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // ✅ Try to get user data from localStorage
    const username = localStorage.getItem('userName');
    const email = localStorage.getItem('userEmail');
    const role = localStorage.getItem('userRole');

    // ✅ Now update profile popup if user is logged in
    if (username && email && role) {
        const usernameElement = document.querySelector('#profilePopup p:nth-of-type(1)');
        const emailElement = document.querySelector('#profilePopup p:nth-of-type(2)');
        const roleElement = document.querySelector('#profilePopup p:nth-of-type(3)');

        if (usernameElement && emailElement && roleElement) {
            usernameElement.innerHTML = `<strong>Username:</strong> ${username}`;
            emailElement.innerHTML = `<strong>Email:</strong> ${email}`;
            roleElement.innerHTML = `<strong>Role:</strong> ${capitalizeFirstLetter(role)}`;
        }
    }
});

function capitalizeFirstLetter(string) {
    return string.charAt(0).toUpperCase() + string.slice(1);
}
</script>

<script>
document.addEventListener('DOMContentLoaded', function() {
const role = localStorage.getItem('userRole');
const profileLink = document.getElementById('profileLink');
const profileLinkText = document.getElementById('profileLinkText');

if (role && profileLink && profileLinkText) {
    if (role.toLowerCase() === 'pharmacist') {
        profileLinkText.textContent = 'Pharmacist Panel';
        profileLink.href = '/pages/pharmacist-panel.html';
        profileLink.style.display = 'inline-flex';
    } else if (role.toLowerCase() === 'admin') {
        profileLinkText.textContent = 'Admin Panel';
        profileLink.href = '/pages/admin.html';
        profileLink.style.display = 'inline-flex';
    } else {
        profileLink.style.display = 'none'; // patient → hide
    }
} else {
    if (profileLink) {
        profileLink.style.display = 'none';
    }
}
});
</script>

  <script src="../assets/js/cart.js"></script>
  <script src="../assets/js/Search.js"></script>
</body>
</html>
